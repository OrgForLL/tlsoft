<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,maximum-scale=1" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <title></title>
    <link type="text/css" rel="stylesheet" href="../../res/css/LeePageSlider.css" />
    <link type="text/css" rel="stylesheet" href="../../res/css/font-awesome.min.css" />
    <style type="text/css">
        .back-img {
            background-position: center center;
            background-repeat: no-repeat;
            background-size: cover;
        }

        .page {
            padding: 0;
            color: #f2f2f2;
            background-color: transparent;
        }

        #index {
            background-image: url(../../res/img/storesaler/page_bg.jpg);
        }

        .color-mask {
            background-color: rgba(0,0,0,.6);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .content {
            z-index: 200;
            margin-top: -10px;
        }

        .headimg {
            width: 66px;
            height: 66px;
            background-color: #f2f2f2;
            margin: 0 auto;
            position: relative;
            z-index: 210;
            border-radius: 2px;
            border: 1px solid #ccc;
        }

        .headimg_wrap {
            margin: 0 0 20px 0;
            text-align: center;
        }

        .head1, .head2 {
            background-color: rgba(255,255,255,.6);
            width: 66px;
            height: 66px;
            position: absolute;
            top: 0;
            left: 50%;
            margin-left: -33px;
            transform: rotate(10deg);
            z-index: 202;
            border-radius: 2px;
        }

        .head2 {
            transform: rotate(20deg);
            background-color: rgba(255,255,255,.4);
            z-index: 201;
        }

        .username {
            font-size: 20px;
            font-weight: bold;
            margin: 32px 0 10px 0;
        }

        .rolename > span {
            background-color: rgba(255,255,255,.5);
            padding: 2px 8px;
            color: #303030;
            font-weight: 600;
            border-radius: 2px;
        }

        .tips {
            text-align: center;
            margin: 60px 0 20px 0;
            font-weight: 400;
        }

        .buttons {
            text-align: center;
            white-space: nowrap;
        }

        .button-item {
            display: inline-block;
            width: 34vw;
            height: 34vw;
            background-color: rgba(255,255,255,.5);
            border-radius: 2px;
            position: relative;
        }

        .nav-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto;
        }

        .nav_name {
            text-align: center;
            color: #222;
            font-weight: 600;
        }

        #company, #store {
            background-color: rgba(0,0,0,.8);
        }

        .select_ul {
            color: #f2f2f2;
            width: 90%;
            margin: 0 auto;
            border: 1px solid #f2f2f2;
            border-radius: 4px;
        }

            .select_ul li {
                height: 40px;
                line-height: 39px;
                padding: 0 10px;
            }

                .select_ul li:active {
                    background-color: #f2f2f2;
                    color: #333;
                }

                .select_ul li .fa {
                    font-size: 18px;
                    float: right;
                    line-height: 38px;
                }

                .select_ul li:not(:last-child) {
                    border-bottom: 1px solid #ccc;
                }

        .back-btn {
            background-color: rgba(240,240,240,.8);
            height: 40px;
            width: 44px;
            color: #333;
            text-align: center;
            line-height: 40px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 2000;
            display: none;
        }

        .navbtns {
            font-size: 0;
        }

        .btnitem {
            width: 50%;
            display: inline-block;
            height: 40px;
            line-height: 40px;
            text-align: center;
            font-size: 14px;
        }

        .list_wrap {
            position: absolute;
            top: 40px;
            left: 0;
            width: 100%;
            bottom: 0;
            overflow-y: auto;
            padding: 10px 0 20px;
        }
    </style>
</head>
<body>
    <div class="wrap-page">
        <div class="page back-img" id="index">
            <div class="color-mask"></div>
            <div class="content center-translate">
                <div class="headimg_wrap">
                    <div class="head1"></div>
                    <div class="head2"></div>
                    <div class="back-img headimg" style="background-image: url(../../res/img/storesaler/vip1.jpg);"></div>
                    <p class="username">李清峰</p>
                    <p class="rolename"><span>总部角色</span></p>
                </div>
                <div class="tips">- 请选择下方管理模式 -</div>
                <div class="buttons">
                    <div class="button-item" style="margin-right: 6vw;" onclick="navRedirct('0')">
                        <div class="center-translate" style="margin-top: -4px;">
                            <div class="back-img nav-icon" style="background-image: url(../../res/img/storesaler/manager_nav_icons.png); background-position: 0 0;"></div>
                            <p class="nav_name">管理者</p>
                        </div>
                    </div>
                    <div class="button-item">
                        <div class="center-translate" style="margin-top: -4px;" onclick="navRedirct('1')">
                            <div class="back-img nav-icon" style="background-image: url(../../res/img/storesaler/manager_nav_icons.png); background-position: 0 -80px;"></div>
                            <p class="nav_name">门店管理</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--贸易公司列表页-->
        <div class="page page-right" id="company">
            <div class="navbtns">
                <div class="btnitem" onclick="javascript:backFunc();">返回</div>
                <div class="btnitem" onclick="javascript:scroll2Top();">置顶</div>
            </div>
            <div class="list_wrap">
                <ul class="select_ul"></ul>
            </div>
        </div>
        <!--门店列表页-->
        <div class="page page-right" id="store">
            <div class="navbtns">
                <div class="btnitem" onclick="javascript:backFunc();">返回</div>
                <div class="btnitem" onclick="javascript:scroll2Top();">置顶</div>
            </div>
            <div class="list_wrap">
                <ul class="select_ul"></ul>
            </div>
        </div>
    </div>

    <script type="text/html" id="company_li_temp">
        <li data-khid="{{khid}}" data-mdid="{{mdid}}">{{khmc}}<i class="fa fa-angle-right"></i></li>
    </script>

    <script type="text/html" id="store_li_temp">
        <li data-khid="{{khid}}" data-mdid="{{mdid}}">{{mddm}}.{{mdmc}}</li>
    </script>

    <script type="text/javascript" src="../../res/js/jquery.js"></script>
    <script type="text/javascript" src="../../res/js/template.js"></script>
    <script type="text/javascript" src="../../res/js/storesaler/fastclick.min.js"></script>
    <script type="text/javascript" src="../../res/js/LeeJSUtils.min.js"></script>
    <script type="text/javascript">
        var currentSite = "index";

        $(document).ready(function () {
            FastClick.attach(document.body);
            LeeJSUtils.LoadMaskInit();
        });

        function navRedirct(code) {
            if (code == "0") {

            } else {
                if ($("#company .select_ul").attr("loaded") != "1")
                    loadCompanyList();
                else {
                    $("#company").removeClass("page-right");
                    currentSite = "company";
                }
            }
        }

        function loadCompanyList() {
            LeeJSUtils.showMessage("loading", "正在加载,请稍候..");
            setTimeout(function () {
                $.ajax({
                    type: "POST",
                    timeout: 5000,
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    url: "managerNavCore.aspx",
                    data: { ctrl: "getCompanyList", roleName:"my", userid:"354" },
                    success: function (msg) {
                        if (msg.indexOf("Error:") > -1)
                            LeeJSUtils.showMessage("error", msg.replace("Error:", ""));
                        else {
                            var data = JSON.parse(msg), html = "";
                            for (var i = 0; i < data.rows.length; i++) {
                                var row = data.rows[i];
                                html += template("company_li_temp", row);
                            }

                            $("#company .select_ul").html(html).attr("loaded", "1");
                            $("#leemask").hide();
                            $("#company").removeClass("page-right");
                            currentSite = "company";
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        LeeJSUtils.showMessage("error", "您的网络有问题..");
                    }
                });//end AJAX
            }, 250);
        }

        function loadStoreList(khid) {
            LeeJSUtils.showMessage("loading", "正在加载,请稍候..");
            setTimeout(function () {
                $.ajax({
                    type: "POST",
                    timeout: 5000,
                    contentType: "application/x-www-form-urlencoded; charset=utf-8",
                    url: "managerNavCore.aspx",
                    data: { ctrl: "getStoreList", khid: khid },
                    success: function (msg) {
                        if (msg.indexOf("Error:") > -1)
                            LeeJSUtils.showMessage("error", msg.replace("Error:", ""));
                        else {
                            var data = JSON.parse(msg), html = "";
                            if (data.rows.length == 0)
                                LeeJSUtils.showMessage("warn", "对不起，查询不到有效数据！");
                            else {
                                for (var i = 0; i < data.rows.length; i++) {
                                    var row = data.rows[i];
                                    html += template("store_li_temp", row);
                                }

                                $("#store .select_ul").empty().html(html);
                                $("#leemask").hide();
                                $("#company").addClass("page-left");
                                $("#store").removeClass("page-right");
                                currentSite = "store";
                            }
                        }
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) {
                        LeeJSUtils.showMessage("error", "您的网络有问题..");
                    }
                });//end AJAX
            }, 250);
        }

        //返回动作
        function backFunc() {
            switch (currentSite) {
                case "index":
                    break;
                case "company":
                    $("#" + currentSite).addClass("page-right");
                    currentSite = "index";
                    break;
                case "store":
                    $("#" + currentSite).addClass("page-right");
                    $("#company").removeClass("page-left");
                    currentSite = "company";
                    break;
            }
        }

        //返回顶部
        function scroll2Top() {
            $("#" + currentSite + " .list_wrap").animate({ scrollTop: 0 }, 200);
        }

        $("#company").on("click", ".select_ul li", function () {
            var khid = $(this).attr("data-khid");
            loadStoreList(khid);
        });

        $("#store").on("click", ".select_ul li", function () {
            alert($(this).text());
        });
    </script>
</body>
</html>
